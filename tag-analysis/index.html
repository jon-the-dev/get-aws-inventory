
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive AWS resource inventory scanner that discovers and catalogs AWS resources across all regions in your account.">
      
      
        <meta name="author" content="AWS Inventory Scanner Team">
      
      
      
        <link rel="prev" href="../usage/">
      
      
        <link rel="next" href="../services/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Tag Analysis - AWS Inventory Scanner</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tag-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AWS Inventory Scanner" class="md-header__button md-logo" aria-label="AWS Inventory Scanner" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AWS Inventory Scanner
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tag Analysis
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/yourusername/aws-inventory-scanner" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aws-inventory-scanner
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AWS Inventory Scanner" class="md-nav__button md-logo" aria-label="AWS Inventory Scanner" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AWS Inventory Scanner
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/yourusername/aws-inventory-scanner" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aws-inventory-scanner
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tag Analysis
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tag Analysis
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Start
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generate-tag-reports-from-existing-inventory" class="md-nav__link">
    <span class="md-ellipsis">
      Generate Tag Reports from Existing Inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specify-output-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Specify Output Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-tag-compliance" class="md-nav__link">
    <span class="md-ellipsis">
      Check Tag Compliance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#report-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Report Formats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Report Formats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary-report" class="md-nav__link">
    <span class="md-ellipsis">
      Summary Report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailed-report" class="md-nav__link">
    <span class="md-ellipsis">
      Detailed Report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv-report" class="md-nav__link">
    <span class="md-ellipsis">
      CSV Report
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compliance-checking" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Checking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compliance Checking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Required Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-report" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Report
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-api" class="md-nav__link">
    <span class="md-ellipsis">
      Python API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-tags-from-single-file" class="md-nav__link">
    <span class="md-ellipsis">
      Extract Tags from Single File
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-missing-required-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Find Missing Required Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-compliance-report" class="md-nav__link">
    <span class="md-ellipsis">
      Generate Compliance Report
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use Cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-tag-coverage-audit" class="md-nav__link">
    <span class="md-ellipsis">
      1. Tag Coverage Audit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cost-allocation-tag-validation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Cost Allocation Tag Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-environment-segregation" class="md-nav__link">
    <span class="md-ellipsis">
      3. Environment Segregation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-tag-standardization" class="md-nav__link">
    <span class="md-ellipsis">
      4. Tag Standardization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-security-tag-audit" class="md-nav__link">
    <span class="md-ellipsis">
      5. Security Tag Audit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tag-extraction-details" class="md-nav__link">
    <span class="md-ellipsis">
      Tag Extraction Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tag Extraction Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-tag-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Tag Formats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-identification" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Identification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-establish-tag-standards" class="md-nav__link">
    <span class="md-ellipsis">
      1. Establish Tag Standards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-use-consistent-tag-keys" class="md-nav__link">
    <span class="md-ellipsis">
      2. Use Consistent Tag Keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-regular-audits" class="md-nav__link">
    <span class="md-ellipsis">
      3. Regular Audits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-remediation-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      4. Remediation Workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-integration-with-cicd" class="md-nav__link">
    <span class="md-ellipsis">
      5. Integration with CI/CD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-tag-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Tag Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Tag Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aws-cost-allocation-tags" class="md-nav__link">
    <span class="md-ellipsis">
      AWS Cost Allocation Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-backup-tags" class="md-nav__link">
    <span class="md-ellipsis">
      AWS Backup Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-and-compliance" class="md-nav__link">
    <span class="md-ellipsis">
      Security and Compliance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#no-tags-found" class="md-nav__link">
    <span class="md-ellipsis">
      No Tags Found
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incorrect-resource-identification" class="md-nav__link">
    <span class="md-ellipsis">
      Incorrect Resource Identification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#large-memory-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Large Memory Usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-tag-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Tag Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-to-database" class="md-nav__link">
    <span class="md-ellipsis">
      Export to Database
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Services
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Output Format
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Start
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generate-tag-reports-from-existing-inventory" class="md-nav__link">
    <span class="md-ellipsis">
      Generate Tag Reports from Existing Inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specify-output-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Specify Output Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-tag-compliance" class="md-nav__link">
    <span class="md-ellipsis">
      Check Tag Compliance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#report-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Report Formats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Report Formats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary-report" class="md-nav__link">
    <span class="md-ellipsis">
      Summary Report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailed-report" class="md-nav__link">
    <span class="md-ellipsis">
      Detailed Report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv-report" class="md-nav__link">
    <span class="md-ellipsis">
      CSV Report
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compliance-checking" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Checking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compliance Checking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Required Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-report" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Report
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-api" class="md-nav__link">
    <span class="md-ellipsis">
      Python API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-tags-from-single-file" class="md-nav__link">
    <span class="md-ellipsis">
      Extract Tags from Single File
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-missing-required-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Find Missing Required Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-compliance-report" class="md-nav__link">
    <span class="md-ellipsis">
      Generate Compliance Report
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use Cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-tag-coverage-audit" class="md-nav__link">
    <span class="md-ellipsis">
      1. Tag Coverage Audit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cost-allocation-tag-validation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Cost Allocation Tag Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-environment-segregation" class="md-nav__link">
    <span class="md-ellipsis">
      3. Environment Segregation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-tag-standardization" class="md-nav__link">
    <span class="md-ellipsis">
      4. Tag Standardization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-security-tag-audit" class="md-nav__link">
    <span class="md-ellipsis">
      5. Security Tag Audit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tag-extraction-details" class="md-nav__link">
    <span class="md-ellipsis">
      Tag Extraction Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tag Extraction Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-tag-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Tag Formats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-identification" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Identification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-establish-tag-standards" class="md-nav__link">
    <span class="md-ellipsis">
      1. Establish Tag Standards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-use-consistent-tag-keys" class="md-nav__link">
    <span class="md-ellipsis">
      2. Use Consistent Tag Keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-regular-audits" class="md-nav__link">
    <span class="md-ellipsis">
      3. Regular Audits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-remediation-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      4. Remediation Workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-integration-with-cicd" class="md-nav__link">
    <span class="md-ellipsis">
      5. Integration with CI/CD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-tag-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Tag Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Tag Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aws-cost-allocation-tags" class="md-nav__link">
    <span class="md-ellipsis">
      AWS Cost Allocation Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-backup-tags" class="md-nav__link">
    <span class="md-ellipsis">
      AWS Backup Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-and-compliance" class="md-nav__link">
    <span class="md-ellipsis">
      Security and Compliance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#no-tags-found" class="md-nav__link">
    <span class="md-ellipsis">
      No Tags Found
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incorrect-resource-identification" class="md-nav__link">
    <span class="md-ellipsis">
      Incorrect Resource Identification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#large-memory-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Large Memory Usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-tag-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Tag Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-to-database" class="md-nav__link">
    <span class="md-ellipsis">
      Export to Database
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/yourusername/aws-inventory-scanner/edit/main/docs/tag-analysis.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<div><h1 id="tag-analysis">Tag Analysis<a class="headerlink" href="#tag-analysis" title="Permanent link">¶</a></h1>
<p>The AWS Inventory Scanner includes a powerful tag analysis feature that helps you understand, audit, and maintain your AWS resource tagging strategy.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">¶</a></h2>
<p>The tag analyzer extracts and analyzes tags from all inventory files, providing insights into:</p>
<ul>
<li><strong>Tag Coverage</strong>: Which resources have tags and which don't</li>
<li><strong>Tag Distribution</strong>: Most commonly used tag keys and values</li>
<li><strong>Tag Compliance</strong>: Resources missing required tags</li>
<li><strong>Tag Inconsistencies</strong>: Similar tag keys that might need standardization</li>
<li><strong>Service Breakdown</strong>: Tag coverage by AWS service</li>
</ul>
<h2 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link">¶</a></h2>
<h3 id="generate-tag-reports-from-existing-inventory">Generate Tag Reports from Existing Inventory<a class="headerlink" href="#generate-tag-reports-from-existing-inventory" title="Permanent link">¶</a></h3>
<p>After running an inventory scan, generate tag reports:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report
</code></pre></div>
<p>This creates three report files in your inventory directory:</p>
<ul>
<li><code>tag-report-summary-YYYYMMDD_HHMMSS.json</code> - Summary statistics</li>
<li><code>tag-report-detailed-YYYYMMDD_HHMMSS.json</code> - Detailed analysis</li>
<li><code>tag-report-YYYYMMDD_HHMMSS.csv</code> - All tags in CSV format</li>
</ul>
<h3 id="specify-output-directory">Specify Output Directory<a class="headerlink" href="#specify-output-directory" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span>--output-dir<span class="w"> </span>./my-inventory
</code></pre></div>
<h3 id="check-tag-compliance">Check Tag Compliance<a class="headerlink" href="#check-tag-compliance" title="Permanent link">¶</a></h3>
<p>Verify that resources have required tags:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span>--required-tags<span class="w"> </span>Environment<span class="w"> </span>Owner<span class="w"> </span>CostCenter
</code></pre></div>
<p>This generates an additional compliance report showing which resources are missing required tags.</p>
<h2 id="report-formats">Report Formats<a class="headerlink" href="#report-formats" title="Permanent link">¶</a></h2>
<h3 id="summary-report">Summary Report<a class="headerlink" href="#summary-report" title="Permanent link">¶</a></h3>
<p>The summary report provides high-level statistics:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="p">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="nt">"generated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2025-11-19T10:30:00Z"</span><span class="p">,</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="nt">"total_resources"</span><span class="p">:</span><span class="w"> </span><span class="mi">1547</span><span class="p">,</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="nt">"resources_with_tags"</span><span class="p">:</span><span class="w"> </span><span class="mi">1203</span><span class="p">,</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="nt">"resources_without_tags"</span><span class="p">:</span><span class="w"> </span><span class="mi">344</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span><span class="nt">"tag_coverage_percent"</span><span class="p">:</span><span class="w"> </span><span class="mf">77.75</span><span class="p">,</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="nt">"unique_tag_keys"</span><span class="p">:</span><span class="w"> </span><span class="mi">47</span><span class="p">,</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span><span class="nt">"total_tag_entries"</span><span class="p">:</span><span class="w"> </span><span class="mi">5431</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">  </span><span class="nt">"tag_key_frequency"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span><span class="nt">"Name"</span><span class="p">:</span><span class="w"> </span><span class="mi">1203</span><span class="p">,</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">    </span><span class="nt">"Environment"</span><span class="p">:</span><span class="w"> </span><span class="mi">987</span><span class="p">,</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">    </span><span class="nt">"Owner"</span><span class="p">:</span><span class="w"> </span><span class="mi">856</span><span class="p">,</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">    </span><span class="nt">"CostCenter"</span><span class="p">:</span><span class="w"> </span><span class="mi">654</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">  </span><span class="nt">"top_tag_values"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">    </span><span class="nt">"Environment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">      </span><span class="nt">"production"</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">      </span><span class="nt">"staging"</span><span class="p">:</span><span class="w"> </span><span class="mi">312</span><span class="p">,</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">      </span><span class="nt">"development"</span><span class="p">:</span><span class="w"> </span><span class="mi">219</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">  </span><span class="nt">"service_breakdown"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="w">    </span><span class="nt">"ec2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="w">      </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mi">450</span><span class="p">,</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="w">      </span><span class="nt">"tagged"</span><span class="p">:</span><span class="w"> </span><span class="mi">425</span><span class="p">,</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="w">      </span><span class="nt">"untagged"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="w">    </span><span class="nt">"s3"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="w">      </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mi">87</span><span class="p">,</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="w">      </span><span class="nt">"tagged"</span><span class="p">:</span><span class="w"> </span><span class="mi">82</span><span class="p">,</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="w">      </span><span class="nt">"untagged"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="p">}</span>
</code></pre></div>
<h3 id="detailed-report">Detailed Report<a class="headerlink" href="#detailed-report" title="Permanent link">¶</a></h3>
<p>The detailed report includes:</p>
<p><strong>Untagged Resources:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">"untagged_resources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">      </span><span class="nt">"service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3"</span><span class="p">,</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">      </span><span class="nt">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"us-east-1"</span><span class="p">,</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">      </span><span class="nt">"resource_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Buckets"</span><span class="p">,</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">      </span><span class="nt">"resource_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-old-bucket"</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">  </span><span class="nt">"untagged_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">344</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Tag Inconsistencies:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="nt">"tag_inconsistencies"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">      </span><span class="nt">"similar_keys"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Environment"</span><span class="p">,</span><span class="w"> </span><span class="s2">"environment"</span><span class="p">,</span><span class="w"> </span><span class="s2">"env"</span><span class="p">],</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">      </span><span class="nt">"recommendation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Standardize to one format"</span><span class="p">,</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">      </span><span class="nt">"pattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"environment"</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">  </span><span class="p">]</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Resources by Tag Key:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span><span class="nt">"resources_by_tag_key"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="nt">"Environment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">      </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">987</span><span class="p">,</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">      </span><span class="nt">"unique_values"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">      </span><span class="nt">"sample_resources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">        </span><span class="p">{</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">          </span><span class="nt">"service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ec2"</span><span class="p">,</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">          </span><span class="nt">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"us-east-1"</span><span class="p">,</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">          </span><span class="nt">"resource_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"i-1234567890abcdef0"</span><span class="p">,</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">      </span><span class="p">]</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="p">}</span>
</code></pre></div>
<h3 id="csv-report">CSV Report<a class="headerlink" href="#csv-report" title="Permanent link">¶</a></h3>
<p>The CSV report contains all tags in a flat format, suitable for importing into spreadsheet applications or databases:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>AccountID,Service,Region,ResourceType,ResourceID,TagKey,TagValue
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>123456789012,ec2,us-east-1,Reservations,i-1234567890abcdef0,Name,WebServer1
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>123456789012,ec2,us-east-1,Reservations,i-1234567890abcdef0,Environment,production
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>123456789012,s3,us-east-1,Buckets,my-bucket,CostCenter,Engineering
</code></pre></div>
<h2 id="compliance-checking">Compliance Checking<a class="headerlink" href="#compliance-checking" title="Permanent link">¶</a></h2>
<h3 id="required-tags">Required Tags<a class="headerlink" href="#required-tags" title="Permanent link">¶</a></h3>
<p>Specify required tags to generate a compliance report:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span>--required-tags<span class="w"> </span>Name<span class="w"> </span>Environment<span class="w"> </span>Owner<span class="w"> </span>CostCenter<span class="w"> </span>Project
</code></pre></div>
<h3 id="compliance-report">Compliance Report<a class="headerlink" href="#compliance-report" title="Permanent link">¶</a></h3>
<p>The compliance report shows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="p">{</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="nt">"generated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2025-11-19T10:30:00Z"</span><span class="p">,</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="nt">"required_tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Environment"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Owner"</span><span class="p">,</span><span class="w"> </span><span class="s2">"CostCenter"</span><span class="p">],</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="nt">"total_resources"</span><span class="p">:</span><span class="w"> </span><span class="mi">1547</span><span class="p">,</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">  </span><span class="nt">"compliant_resources"</span><span class="p">:</span><span class="w"> </span><span class="mi">856</span><span class="p">,</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">  </span><span class="nt">"non_compliant_resources"</span><span class="p">:</span><span class="w"> </span><span class="mi">691</span><span class="p">,</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">  </span><span class="nt">"compliance_percentage"</span><span class="p">:</span><span class="w"> </span><span class="mf">55.33</span><span class="p">,</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">  </span><span class="nt">"non_compliant_details"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">      </span><span class="nt">"service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ec2"</span><span class="p">,</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">      </span><span class="nt">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"us-east-1"</span><span class="p">,</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">      </span><span class="nt">"resource_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"i-9876543210fedcba0"</span><span class="p">,</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">      </span><span class="nt">"missing_tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Owner"</span><span class="p">,</span><span class="w"> </span><span class="s2">"CostCenter"</span><span class="p">]</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">  </span><span class="p">]</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="p">}</span>
</code></pre></div>
<h2 id="python-api">Python API<a class="headerlink" href="#python-api" title="Permanent link">¶</a></h2>
<h3 id="basic-usage">Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">aws_inventory_scanner</span><span class="w"> </span><span class="kn">import</span> <span class="n">TagAnalyzer</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># Create analyzer</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">analyzer</span> <span class="o">=</span> <span class="n">TagAnalyzer</span><span class="p">(</span><span class="n">inventory_dir</span><span class="o">=</span><span class="s2">"./inventory"</span><span class="p">)</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c1"># Extract tags from all files</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">tags_data</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">extract_tags_from_directory</span><span class="p">()</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c1"># Generate reports</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="n">report_files</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">generate_tag_report</span><span class="p">(</span><span class="n">tags_data</span><span class="p">)</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Reports generated: </span><span class="si">{</span><span class="n">report_files</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<h3 id="extract-tags-from-single-file">Extract Tags from Single File<a class="headerlink" href="#extract-tags-from-single-file" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">extract_tags_from_file</span><span class="p">(</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="s2">"./inventory/123456789012-ec2-us-east-1-describe_instances-Reservations.json"</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="p">)</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s1">'resources'</span><span class="p">]:</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Resource: </span><span class="si">{</span><span class="n">resource</span><span class="p">[</span><span class="s1">'resource_id'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">resource</span><span class="p">[</span><span class="s1">'tags'</span><span class="p">]:</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  </span><span class="si">{</span><span class="n">tag</span><span class="p">[</span><span class="s1">'Key'</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">tag</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<h3 id="find-missing-required-tags">Find Missing Required Tags<a class="headerlink" href="#find-missing-required-tags" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">required_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Environment"</span><span class="p">,</span> <span class="s2">"Owner"</span><span class="p">,</span> <span class="s2">"CostCenter"</span><span class="p">]</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">missing</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">find_missing_required_tags</span><span class="p">(</span><span class="n">tags_data</span><span class="p">,</span> <span class="n">required_tags</span><span class="p">)</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span><span class="si">}</span><span class="s2"> resources missing required tags"</span><span class="p">)</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">missing</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">resource</span><span class="p">[</span><span class="s1">'service'</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">resource</span><span class="p">[</span><span class="s1">'resource_id'</span><span class="p">]</span><span class="si">}</span><span class="s2">: missing </span><span class="si">{</span><span class="n">resource</span><span class="p">[</span><span class="s1">'missing_tags'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<h3 id="generate-compliance-report">Generate Compliance Report<a class="headerlink" href="#generate-compliance-report" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">compliance</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">generate_compliance_report</span><span class="p">(</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    <span class="n">tags_data</span><span class="p">,</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="n">required_tags</span><span class="o">=</span><span class="p">[</span><span class="s2">"Name"</span><span class="p">,</span> <span class="s2">"Environment"</span><span class="p">,</span> <span class="s2">"Owner"</span><span class="p">],</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="n">output_file</span><span class="o">=</span><span class="s2">"./compliance-report.json"</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="p">)</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Compliance: </span><span class="si">{</span><span class="n">compliance</span><span class="p">[</span><span class="s1">'compliance_percentage'</span><span class="p">]</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</code></pre></div>
<h2 id="use-cases">Use Cases<a class="headerlink" href="#use-cases" title="Permanent link">¶</a></h2>
<h3 id="1-tag-coverage-audit">1. Tag Coverage Audit<a class="headerlink" href="#1-tag-coverage-audit" title="Permanent link">¶</a></h3>
<p><strong>Scenario</strong>: You want to know what percentage of your AWS resources have tags.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report
</code></pre></div>
<p><strong>Look for:</strong>
- <code>summary.tag_coverage_percent</code> in the summary report
- <code>untagged_resources</code> in the detailed report</p>
<h3 id="2-cost-allocation-tag-validation">2. Cost Allocation Tag Validation<a class="headerlink" href="#2-cost-allocation-tag-validation" title="Permanent link">¶</a></h3>
<p><strong>Scenario</strong>: Ensure all resources have CostCenter tags for billing purposes.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">  </span>--required-tags<span class="w"> </span>CostCenter
</code></pre></div>
<p><strong>Look for:</strong>
- <code>compliance_percentage</code> in the compliance report
- Resources with missing CostCenter tag</p>
<h3 id="3-environment-segregation">3. Environment Segregation<a class="headerlink" href="#3-environment-segregation" title="Permanent link">¶</a></h3>
<p><strong>Scenario</strong>: Verify all resources are properly tagged with Environment (production/staging/development).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report
</code></pre></div>
<p><strong>Look for:</strong>
- <code>top_tag_values.Environment</code> in the summary report
- Resources without Environment tag in untagged list</p>
<h3 id="4-tag-standardization">4. Tag Standardization<a class="headerlink" href="#4-tag-standardization" title="Permanent link">¶</a></h3>
<p><strong>Scenario</strong>: Find and fix tag key inconsistencies (e.g., "environment" vs "Environment").</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span>--verbose
</code></pre></div>
<p><strong>Look for:</strong>
- <code>tag_inconsistencies</code> in the detailed report
- Similar keys that should be standardized</p>
<h3 id="5-security-tag-audit">5. Security Tag Audit<a class="headerlink" href="#5-security-tag-audit" title="Permanent link">¶</a></h3>
<p><strong>Scenario</strong>: Ensure all resources have Owner tag for security accountability.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">  </span>--required-tags<span class="w"> </span>Owner
</code></pre></div>
<p><strong>Look for:</strong>
- Resources missing Owner tag in compliance report
- Tag compliance percentage</p>
<h2 id="tag-extraction-details">Tag Extraction Details<a class="headerlink" href="#tag-extraction-details" title="Permanent link">¶</a></h2>
<h3 id="supported-tag-formats">Supported Tag Formats<a class="headerlink" href="#supported-tag-formats" title="Permanent link">¶</a></h3>
<p>The analyzer automatically detects and extracts tags in various AWS formats:</p>
<p><strong>Array Format (most common):</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nt">"Tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">  </span><span class="p">{</span><span class="nt">"Key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Name"</span><span class="p">,</span><span class="w"> </span><span class="nt">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyResource"</span><span class="p">},</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">  </span><span class="p">{</span><span class="nt">"Key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Environment"</span><span class="p">,</span><span class="w"> </span><span class="nt">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">}</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="p">]</span>
</code></pre></div>
<p><strong>Dictionary Format:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nt">"Tags"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="nt">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyResource"</span><span class="p">,</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">  </span><span class="nt">"Environment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Alternative Key Names:</strong>
- <code>Tags</code>
- <code>TagList</code>
- <code>tags</code>
- <code>TagSet</code>
- <code>TagSpecifications</code></p>
<h3 id="resource-identification">Resource Identification<a class="headerlink" href="#resource-identification" title="Permanent link">¶</a></h3>
<p>The analyzer identifies resources using various ID fields:</p>
<ul>
<li>Generic: <code>ResourceId</code>, <code>Id</code>, <code>ARN</code>, <code>Name</code></li>
<li>EC2: <code>InstanceId</code>, <code>VolumeId</code>, <code>VpcId</code>, <code>SubnetId</code>, <code>GroupId</code></li>
<li>S3: <code>BucketName</code></li>
<li>RDS: <code>DBInstanceIdentifier</code>, <code>ClusterIdentifier</code></li>
<li>Lambda: <code>FunctionName</code></li>
<li>ELB: <code>LoadBalancerName</code>, <code>LoadBalancerArn</code></li>
<li>And many more...</li>
</ul>
<p>If no standard field is found, it looks for any field ending with "Id" or "ID".</p>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">¶</a></h2>
<h3 id="1-establish-tag-standards">1. Establish Tag Standards<a class="headerlink" href="#1-establish-tag-standards" title="Permanent link">¶</a></h3>
<p>Define a standard set of tags for your organization:</p>
<p><strong>Minimum Required Tags:</strong>
- <code>Name</code> - Human-readable resource name
- <code>Environment</code> - production/staging/development/test
- <code>Owner</code> - Team or person responsible
- <code>CostCenter</code> - For billing allocation</p>
<p><strong>Recommended Tags:</strong>
- <code>Project</code> - Project or application name
- <code>Compliance</code> - Compliance requirements (PCI, HIPAA, etc.)
- <code>BackupPolicy</code> - Backup schedule or policy
- <code>DataClassification</code> - public/internal/confidential/restricted</p>
<h3 id="2-use-consistent-tag-keys">2. Use Consistent Tag Keys<a class="headerlink" href="#2-use-consistent-tag-keys" title="Permanent link">¶</a></h3>
<p>Always use PascalCase for tag keys:
- ✅ <code>Environment</code>, <code>CostCenter</code>, <code>DataClassification</code>
- ❌ <code>environment</code>, <code>cost-center</code>, <code>data_classification</code></p>
<h3 id="3-regular-audits">3. Regular Audits<a class="headerlink" href="#3-regular-audits" title="Permanent link">¶</a></h3>
<p>Schedule regular tag audits:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Weekly audit script</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c1">#!/bin/bash</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>aws-inventory-scanner<span class="w"> </span>--region<span class="w"> </span>us-east-1<span class="w"> </span>us-west-2
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">  </span>--required-tags<span class="w"> </span>Name<span class="w"> </span>Environment<span class="w"> </span>Owner<span class="w"> </span>CostCenter
</code></pre></div>
<h3 id="4-remediation-workflow">4. Remediation Workflow<a class="headerlink" href="#4-remediation-workflow" title="Permanent link">¶</a></h3>
<ol>
<li><strong>Generate report</strong> to identify untagged resources</li>
<li><strong>Review CSV export</strong> to find patterns</li>
<li><strong>Apply tags</strong> using AWS CLI or console</li>
<li><strong>Re-run report</strong> to verify compliance</li>
</ol>
<h3 id="5-integration-with-cicd">5. Integration with CI/CD<a class="headerlink" href="#5-integration-with-cicd" title="Permanent link">¶</a></h3>
<p>Add tag compliance checks to your deployment pipelines:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">aws_inventory_scanner</span><span class="w"> </span><span class="kn">import</span> <span class="n">TagAnalyzer</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">analyzer</span> <span class="o">=</span> <span class="n">TagAnalyzer</span><span class="p">(</span><span class="s2">"./inventory"</span><span class="p">)</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="n">tags_data</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">extract_tags_from_directory</span><span class="p">()</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="n">required_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Environment"</span><span class="p">,</span> <span class="s2">"Owner"</span><span class="p">,</span> <span class="s2">"CostCenter"</span><span class="p">]</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="n">compliance</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">generate_compliance_report</span><span class="p">(</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>    <span class="n">tags_data</span><span class="p">,</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>    <span class="n">required_tags</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="p">)</span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="k">if</span> <span class="n">compliance</span><span class="p">[</span><span class="s1">'compliance_percentage'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">95</span><span class="p">:</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ERROR: Tag compliance is </span><span class="si">{</span><span class="n">compliance</span><span class="p">[</span><span class="s1">'compliance_percentage'</span><span class="p">]</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Required: 95% or higher"</span><span class="p">)</span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h2 id="common-tag-patterns">Common Tag Patterns<a class="headerlink" href="#common-tag-patterns" title="Permanent link">¶</a></h2>
<h3 id="aws-cost-allocation-tags">AWS Cost Allocation Tags<a class="headerlink" href="#aws-cost-allocation-tags" title="Permanent link">¶</a></h3>
<p>Enable these tags for cost allocation in AWS Cost Explorer:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span>--required-tags<span class="w"> </span>CostCenter<span class="w"> </span>Project<span class="w"> </span>Environment
</code></pre></div>
<h3 id="aws-backup-tags">AWS Backup Tags<a class="headerlink" href="#aws-backup-tags" title="Permanent link">¶</a></h3>
<p>For automated backups based on tags:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">  </span>--required-tags<span class="w"> </span>BackupPolicy
</code></pre></div>
<h3 id="security-and-compliance">Security and Compliance<a class="headerlink" href="#security-and-compliance" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">  </span>--required-tags<span class="w"> </span>DataClassification<span class="w"> </span>Compliance<span class="w"> </span>Owner
</code></pre></div>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">¶</a></h2>
<h3 id="no-tags-found">No Tags Found<a class="headerlink" href="#no-tags-found" title="Permanent link">¶</a></h3>
<p><strong>Issue</strong>: Report shows 0 tags even though resources have tags.</p>
<p><strong>Solutions:</strong>
1. Verify inventory files exist in the output directory
2. Check that inventory scan completed successfully
3. Ensure JSON files are valid (not .txt fallback files)
4. Some services may not include tags in their list/describe responses</p>
<h3 id="incorrect-resource-identification">Incorrect Resource Identification<a class="headerlink" href="#incorrect-resource-identification" title="Permanent link">¶</a></h3>
<p><strong>Issue</strong>: Resources show as "unknown" in reports.</p>
<p><strong>Solution</strong>: The resource type may use a non-standard ID field. The analyzer tries common patterns, but some resources may need custom handling.</p>
<h3 id="large-memory-usage">Large Memory Usage<a class="headerlink" href="#large-memory-usage" title="Permanent link">¶</a></h3>
<p><strong>Issue</strong>: Tag analysis consumes too much memory with large inventories.</p>
<p><strong>Solution</strong>: Process one service at a time by filtering JSON files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># Process only EC2 tags</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>mkdir<span class="w"> </span>temp-ec2
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>cp<span class="w"> </span>*-ec2-*.json<span class="w"> </span>temp-ec2/
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>aws-inventory-scanner<span class="w"> </span>--generate-tag-report<span class="w"> </span>--output-dir<span class="w"> </span>temp-ec2
</code></pre></div>
<h2 id="advanced-features">Advanced Features<a class="headerlink" href="#advanced-features" title="Permanent link">¶</a></h2>
<h3 id="custom-tag-analysis">Custom Tag Analysis<a class="headerlink" href="#custom-tag-analysis" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">aws_inventory_scanner</span><span class="w"> </span><span class="kn">import</span> <span class="n">TagAnalyzer</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="n">analyzer</span> <span class="o">=</span> <span class="n">TagAnalyzer</span><span class="p">(</span><span class="s2">"./inventory"</span><span class="p">)</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="n">tags_data</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">extract_tags_from_directory</span><span class="p">()</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="c1"># Find resources with specific tag value</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="n">production_resources</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>    <span class="n">tag</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags_data</span><span class="p">[</span><span class="s1">'tags'</span><span class="p">]</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>    <span class="k">if</span> <span class="n">tag</span><span class="p">[</span><span class="s1">'tag_key'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Environment'</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">[</span><span class="s1">'tag_value'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'production'</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="p">]</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">production_resources</span><span class="p">)</span><span class="si">}</span><span class="s2"> production resources"</span><span class="p">)</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="c1"># Find all unique tag keys</span>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tag</span><span class="p">[</span><span class="s1">'tag_key'</span><span class="p">]</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags_data</span><span class="p">[</span><span class="s1">'tags'</span><span class="p">])</span>
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unique tag keys: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">all_keys</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="c1"># Count resources by service</span>
<a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="n">service_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">'service'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">tags_data</span><span class="p">[</span><span class="s1">'resources'</span><span class="p">])</span>
<a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Resources by service: </span><span class="si">{</span><span class="n">service_counts</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<h3 id="export-to-database">Export to Database<a class="headerlink" href="#export-to-database" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">aws_inventory_scanner</span><span class="w"> </span><span class="kn">import</span> <span class="n">TagAnalyzer</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1"># Create database</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">'aws_tags.db'</span><span class="p">)</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'''</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="s1">    CREATE TABLE IF NOT EXISTS resource_tags (</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="s1">        account_id TEXT,</span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="s1">        service TEXT,</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="s1">        region TEXT,</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="s1">        resource_id TEXT,</span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="s1">        tag_key TEXT,</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="s1">        tag_value TEXT,</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="s1">        scanned_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP</span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="s1">    )</span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="s1">'''</span><span class="p">)</span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="c1"># Load tag data</span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="n">analyzer</span> <span class="o">=</span> <span class="n">TagAnalyzer</span><span class="p">(</span><span class="s2">"./inventory"</span><span class="p">)</span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="n">tags_data</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">extract_tags_from_directory</span><span class="p">()</span>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="c1"># Insert into database</span>
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a><span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags_data</span><span class="p">[</span><span class="s1">'tags'</span><span class="p">]:</span>
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'''</span>
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a><span class="s1">        INSERT INTO resource_tags</span>
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a><span class="s1">        (account_id, service, region, resource_id, tag_key, tag_value)</span>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a><span class="s1">        VALUES (?, ?, ?, ?, ?, ?)</span>
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a><span class="s1">    '''</span><span class="p">,</span> <span class="p">(</span>
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a>        <span class="n">tag</span><span class="p">[</span><span class="s1">'account_id'</span><span class="p">],</span>
<a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a>        <span class="n">tag</span><span class="p">[</span><span class="s1">'service'</span><span class="p">],</span>
<a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a>        <span class="n">tag</span><span class="p">[</span><span class="s1">'region'</span><span class="p">],</span>
<a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a>        <span class="n">tag</span><span class="p">[</span><span class="s1">'resource_id'</span><span class="p">],</span>
<a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a>        <span class="n">tag</span><span class="p">[</span><span class="s1">'tag_key'</span><span class="p">],</span>
<a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a>        <span class="n">tag</span><span class="p">[</span><span class="s1">'tag_value'</span><span class="p">]</span>
<a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a>    <span class="p">))</span>
<a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a>
<a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<h2 id="see-also">See Also<a class="headerlink" href="#see-also" title="Permanent link">¶</a></h2>
<ul>
<li><a href="../usage/">Usage Guide</a> - How to run inventory scans</li>
<li><a href="../output/">Output Format</a> - Understanding inventory file format</li>
<li><a href="../api/">API Reference</a> - Python API documentation</li>
</ul></div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="February 17, 2026 01:21:29 UTC">February 17, 2026</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "search.share", "content.code.annotate", "navigation.top", "content.action.edit"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>